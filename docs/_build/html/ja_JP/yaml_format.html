
<!DOCTYPE html>

<html lang="ja-JP">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>YAML Format &#8212; Dagu 1.10 ドキュメント</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <link rel="index" title="索引" href="genindex.html" />
    <link rel="search" title="検索" href="search.html" />
    <link rel="next" title="Base Configuration for all DAGs" href="base_config.html" />
    <link rel="prev" title="Web Interface" href="web_interface.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="yaml-format">
<span id="id1"></span><h1>YAML Format<a class="headerlink" href="#yaml-format" title="この見出しへのパーマリンク">¶</a></h1>
<nav class="contents local" id="id2">
<ul class="simple">
<li><p><a class="reference internal" href="#minimal-dag-definition" id="id3">Minimal DAG Definition</a></p></li>
<li><p><a class="reference internal" href="#specifying-working-directory" id="id4">Specifying Working Directory</a></p></li>
<li><p><a class="reference internal" href="#running-arbitrary-code-snippets" id="id5">Running Arbitrary Code Snippets</a></p></li>
<li><p><a class="reference internal" href="#defining-environment-variables" id="id6">Defining Environment Variables</a></p></li>
<li><p><a class="reference internal" href="#defining-and-using-parameters" id="id7">Defining and Using Parameters</a></p></li>
<li><p><a class="reference internal" href="#using-command-substitution" id="id8">Using Command Substitution</a></p></li>
<li><p><a class="reference internal" href="#adding-conditional-logic" id="id9">Adding Conditional Logic</a></p></li>
<li><p><a class="reference internal" href="#user-defined-functions" id="id10">User Defined Functions</a></p></li>
<li><p><a class="reference internal" href="#setting-environment-variables-with-standard-output" id="id11">Setting Environment Variables with Standard Output</a></p></li>
<li><p><a class="reference internal" href="#redirecting-stdout-and-stderr" id="id12">Redirecting Stdout and Stderr</a></p></li>
<li><p><a class="reference internal" href="#adding-lifecycle-hooks" id="id13">Adding Lifecycle Hooks</a></p></li>
<li><p><a class="reference internal" href="#repeating-a-task-at-regular-intervals" id="id14">Repeating a Task at Regular Intervals</a></p></li>
<li><p><a class="reference internal" href="#scheduling-a-dag-with-cron-expression" id="id15">Scheduling a DAG with Cron Expression</a></p></li>
<li><p><a class="reference internal" href="#all-available-fields-for-dags" id="id16">All Available Fields for DAGs</a></p></li>
<li><p><a class="reference internal" href="#all-available-fields-for-steps" id="id17">All Available Fields for Steps</a></p></li>
</ul>
</nav>
<section id="minimal-dag-definition">
<h2><a class="toc-backref" href="#id3" role="doc-backlink">Minimal DAG Definition</a><a class="headerlink" href="#minimal-dag-definition" title="この見出しへのパーマリンク">¶</a></h2>
<p>The minimal DAG definition is as simple as follows.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">steps</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">step 1</span>
<span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">echo hello</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">step 2</span>
<span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">echo world</span>
<span class="w">    </span><span class="nt">depends</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">step 1</span>
</pre></div>
</div>
</section>
<section id="specifying-working-directory">
<span id="specifying-working-dir"></span><h2><a class="toc-backref" href="#id4" role="doc-backlink">Specifying Working Directory</a><a class="headerlink" href="#specifying-working-directory" title="この見出しへのパーマリンク">¶</a></h2>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">steps</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">step 1</span>
<span class="w">    </span><span class="nt">dir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/path/to/working/directory</span>
<span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">some command</span>
</pre></div>
</div>
</section>
<section id="running-arbitrary-code-snippets">
<h2><a class="toc-backref" href="#id5" role="doc-backlink">Running Arbitrary Code Snippets</a><a class="headerlink" href="#running-arbitrary-code-snippets" title="この見出しへのパーマリンク">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">script</span></code> field provides a way to run arbitrary snippets of code in any language.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">steps</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">step 1</span>
<span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;bash&quot;</span>
<span class="w">    </span><span class="nt">script</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">      </span><span class="no">cd /tmp</span>
<span class="w">      </span><span class="no">echo &quot;hello world&quot; &gt; hello</span>
<span class="w">      </span><span class="no">cat hello</span>
<span class="w">    </span><span class="nt">output</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">RESULT</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">step 2</span>
<span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">echo ${RESULT}</span><span class="w"> </span><span class="c1"># hello world</span>
<span class="w">    </span><span class="nt">depends</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">step 1</span>
</pre></div>
</div>
</section>
<section id="defining-environment-variables">
<h2><a class="toc-backref" href="#id6" role="doc-backlink">Defining Environment Variables</a><a class="headerlink" href="#defining-environment-variables" title="この見出しへのパーマリンク">¶</a></h2>
<p>You can define environment variables and refer to them using the <code class="docutils literal notranslate"><span class="pre">env</span></code> field.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">env</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">SOME_DIR</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${HOME}/batch</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">SOME_FILE</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${SOME_DIR}/some_file</span>
<span class="nt">steps</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">some task in some dir</span>
<span class="w">    </span><span class="nt">dir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${SOME_DIR}</span>
<span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">python main.py ${SOME_FILE}</span>
</pre></div>
</div>
</section>
<section id="defining-and-using-parameters">
<h2><a class="toc-backref" href="#id7" role="doc-backlink">Defining and Using Parameters</a><a class="headerlink" href="#defining-and-using-parameters" title="この見出しへのパーマリンク">¶</a></h2>
<p>You can define parameters using the <code class="docutils literal notranslate"><span class="pre">params</span></code> field and refer to each parameter as $1, $2, etc. Parameters can also be command substitutions or environment variables. It can be overridden by the <code class="docutils literal notranslate"><span class="pre">--params=</span></code> parameter of the <code class="docutils literal notranslate"><span class="pre">start</span></code> command.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">params</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">param1 param2</span>
<span class="nt">steps</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">some task with parameters</span>
<span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">python main.py $1 $2</span>
</pre></div>
</div>
<p>Named parameters are also available as follows.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">params</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ONE=1 TWO=`echo 2`</span>
<span class="nt">steps</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">some task with parameters</span>
<span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">python main.py $ONE $TWO</span>
</pre></div>
</div>
</section>
<section id="using-command-substitution">
<h2><a class="toc-backref" href="#id8" role="doc-backlink">Using Command Substitution</a><a class="headerlink" href="#using-command-substitution" title="この見出しへのパーマリンク">¶</a></h2>
<p>You can use command substitution in field values. I.e., a string enclosed in backquotes (`) is evaluated as a command and replaced with the result of standard output.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">env</span><span class="p">:</span>
<span class="w">  </span><span class="nt">TODAY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;`date</span><span class="nv"> </span><span class="s">&#39;+%Y%m%d&#39;`&quot;</span>
<span class="nt">steps</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">hello</span>
<span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;echo</span><span class="nv"> </span><span class="s">hello,</span><span class="nv"> </span><span class="s">today</span><span class="nv"> </span><span class="s">is</span><span class="nv"> </span><span class="s">${TODAY}&quot;</span>
</pre></div>
</div>
</section>
<section id="adding-conditional-logic">
<h2><a class="toc-backref" href="#id9" role="doc-backlink">Adding Conditional Logic</a><a class="headerlink" href="#adding-conditional-logic" title="この見出しへのパーマリンク">¶</a></h2>
<p>Sometimes you have parts of a DAG that you only want to run under certain conditions. You can use the <code class="docutils literal notranslate"><span class="pre">preconditions</span></code> field to add conditional branches to your DAG.</p>
<p>For example, the task below only runs on the first date of each month.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">steps</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">A monthly task</span>
<span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">monthly.sh</span>
<span class="w">    </span><span class="nt">preconditions</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">condition</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;`date</span><span class="nv"> </span><span class="s">&#39;+%d&#39;`&quot;</span>
<span class="w">        </span><span class="nt">expected</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;01&quot;</span>
</pre></div>
</div>
<p>If you want the DAG to continue to the next step regardless of the step’s conditional check result, you can use the <code class="docutils literal notranslate"><span class="pre">continueOn</span></code> field:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">steps</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">A monthly task</span>
<span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">monthly.sh</span>
<span class="w">    </span><span class="nt">preconditions</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">condition</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;`date</span><span class="nv"> </span><span class="s">&#39;+%d&#39;`&quot;</span>
<span class="w">        </span><span class="nt">expected</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;01&quot;</span>
<span class="w">    </span><span class="nt">continueOn</span><span class="p">:</span>
<span class="w">      </span><span class="nt">skipped</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</pre></div>
</div>
</section>
<section id="user-defined-functions">
<h2><a class="toc-backref" href="#id10" role="doc-backlink">User Defined Functions</a><a class="headerlink" href="#user-defined-functions" title="この見出しへのパーマリンク">¶</a></h2>
<p>You can define functions in the DAG file and call them in steps. The <code class="docutils literal notranslate"><span class="pre">params</span></code> field is required for functions. The <code class="docutils literal notranslate"><span class="pre">args</span></code> field is used to pass arguments to functions. The arguments can be command substitutions or environment variables.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">functions</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my_function</span>
<span class="w">    </span><span class="nt">params</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">param1 param2</span>
<span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">python main.py $param1 $param2</span>

<span class="nt">steps</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">step 1</span>
<span class="w">    </span><span class="nt">call</span><span class="p">:</span>
<span class="w">      </span><span class="nt">function</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my_function</span>
<span class="w">      </span><span class="nt">args</span><span class="p">:</span>
<span class="w">        </span><span class="nt">param1</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">        </span><span class="nt">param2</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span>
</pre></div>
</div>
</section>
<section id="setting-environment-variables-with-standard-output">
<h2><a class="toc-backref" href="#id11" role="doc-backlink">Setting Environment Variables with Standard Output</a><a class="headerlink" href="#setting-environment-variables-with-standard-output" title="この見出しへのパーマリンク">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">output</span></code> field can be used to set an environment variable with standard output. Leading and trailing space will be trimmed automatically. The environment variables can be used in subsequent steps.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">steps</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">step 1</span>
<span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;echo</span><span class="nv"> </span><span class="s">foo&quot;</span>
<span class="w">    </span><span class="nt">output</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">FOO</span><span class="w"> </span><span class="c1"># will contain &quot;foo&quot;</span>
</pre></div>
</div>
</section>
<section id="redirecting-stdout-and-stderr">
<h2><a class="toc-backref" href="#id12" role="doc-backlink">Redirecting Stdout and Stderr</a><a class="headerlink" href="#redirecting-stdout-and-stderr" title="この見出しへのパーマリンク">¶</a></h2>
<p>The <cite>stdout</cite> field can be used to write standard output to a file.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">steps</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">create a file</span>
<span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;echo</span><span class="nv"> </span><span class="s">hello&quot;</span>
<span class="w">    </span><span class="nt">stdout</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/tmp/hello&quot;</span><span class="w"> </span><span class="c1"># the content will be &quot;hello\n&quot;</span>
</pre></div>
</div>
<p>The <cite>stderr</cite> field allows to redirect stderr to other file without writing to the normal log file.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">steps</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">output error file</span>
<span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;echo</span><span class="nv"> </span><span class="s">error</span><span class="nv"> </span><span class="s">message</span><span class="nv"> </span><span class="s">&gt;&amp;2&quot;</span>
<span class="w">    </span><span class="nt">stderr</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/tmp/error.txt&quot;</span>
</pre></div>
</div>
</section>
<section id="adding-lifecycle-hooks">
<h2><a class="toc-backref" href="#id13" role="doc-backlink">Adding Lifecycle Hooks</a><a class="headerlink" href="#adding-lifecycle-hooks" title="この見出しへのパーマリンク">¶</a></h2>
<p>It is often desirable to take action when a specific event happens, for example, when a DAG fails. To achieve this, you can use <cite>handlerOn</cite> fields.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">handlerOn</span><span class="p">:</span>
<span class="w">  </span><span class="nt">failure</span><span class="p">:</span>
<span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">notify_error.sh</span>
<span class="w">  </span><span class="nt">exit</span><span class="p">:</span>
<span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cleanup.sh</span>
<span class="nt">steps</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">A task</span>
<span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">main.sh</span>
</pre></div>
</div>
</section>
<section id="repeating-a-task-at-regular-intervals">
<h2><a class="toc-backref" href="#id14" role="doc-backlink">Repeating a Task at Regular Intervals</a><a class="headerlink" href="#repeating-a-task-at-regular-intervals" title="この見出しへのパーマリンク">¶</a></h2>
<p>If you want a task to repeat execution at regular intervals, you can use the <cite>repeatPolicy</cite> field. If you want to stop the repeating task, you can use the <cite>stop</cite> command to gracefully stop the task.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">steps</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">A task</span>
<span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">main.sh</span>
<span class="w">    </span><span class="nt">repeatPolicy</span><span class="p">:</span>
<span class="w">      </span><span class="nt">repeat</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">      </span><span class="nt">intervalSec</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">60</span>
</pre></div>
</div>
</section>
<section id="scheduling-a-dag-with-cron-expression">
<h2><a class="toc-backref" href="#id15" role="doc-backlink">Scheduling a DAG with Cron Expression</a><a class="headerlink" href="#scheduling-a-dag-with-cron-expression" title="この見出しへのパーマリンク">¶</a></h2>
<p>You can use the <cite>schedule</cite> field to schedule a DAG with Cron expression.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">schedule</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;5</span><span class="nv"> </span><span class="s">4</span><span class="nv"> </span><span class="s">*</span><span class="nv"> </span><span class="s">*</span><span class="nv"> </span><span class="s">*&quot;</span><span class="w"> </span><span class="c1"># Run at 04:05.</span>
<span class="nt">steps</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">scheduled job</span>
<span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">job.sh</span>
</pre></div>
</div>
<p>See <a class="reference internal" href="scheduler.html#scheduler-configuration"><span class="std std-ref">Scheduler</span></a> for more details.</p>
</section>
<section id="all-available-fields-for-dags">
<h2><a class="toc-backref" href="#id16" role="doc-backlink">All Available Fields for DAGs</a><a class="headerlink" href="#all-available-fields-for-dags" title="この見出しへのパーマリンク">¶</a></h2>
<p>This section provides a comprehensive list of available fields that can be used to configure DAGs and their steps in detail. Each field serves a specific purpose, enabling granular control over how the DAG runs. The fields include:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">name</span></code>: The name of the DAG, which is optional. The default name is the name of the file.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">description</span></code>: A brief description of the DAG.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">schedule</span></code>: The execution schedule of the DAG in Cron expression format.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">group</span></code>: The group name to organize DAGs, which is optional.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tags</span></code>: Free tags that can be used to categorize DAGs, separated by commas.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">env</span></code>: Environment variables that can be accessed by the DAG and its steps.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">logDir</span></code>: The directory where the standard output is written. The default value is <code class="docutils literal notranslate"><span class="pre">${DAGU_HOME}/logs/dags</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">restartWaitSec</span></code>: The number of seconds to wait after the DAG process stops before restarting it.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">histRetentionDays</span></code>: The number of days to retain execution history (not for log files).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">delaySec</span></code>: The interval time in seconds between steps.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">maxActiveRuns</span></code>: The maximum number of parallel running steps.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">params</span></code>: The default parameters that can be referred to by <code class="docutils literal notranslate"><span class="pre">$1</span></code>, <code class="docutils literal notranslate"><span class="pre">$2</span></code>, and so on.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">preconditions</span></code>: The conditions that must be met before a DAG or step can run.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">mailOn</span></code>: Whether to send an email notification when a DAG or step fails or succeeds.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">MaxCleanUpTimeSec</span></code>: The maximum time to wait after sending a TERM signal to running steps before killing them.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">handlerOn</span></code>: The command to execute when a DAG or step succeeds, fails, cancels, or exits.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">steps</span></code>: A list of steps to execute in the DAG.</p></li>
</ul>
<p>In addition, a global configuration file, <code class="docutils literal notranslate"><span class="pre">$DAGU_HOME/config.yaml</span></code>, can be used to gather common settings, such as <code class="docutils literal notranslate"><span class="pre">logDir</span></code> or <code class="docutils literal notranslate"><span class="pre">env</span></code>.</p>
<p>Note: If <code class="docutils literal notranslate"><span class="pre">DAGU_HOME</span></code> environment variable is not set, the default path is <code class="docutils literal notranslate"><span class="pre">$HOME/.dagu/config.yaml</span></code>.</p>
<p>Example:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">DAG name</span>
<span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">run a DAG</span>
<span class="nt">schedule</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;0</span><span class="nv"> </span><span class="s">*</span><span class="nv"> </span><span class="s">*</span><span class="nv"> </span><span class="s">*</span><span class="nv"> </span><span class="s">*&quot;</span>
<span class="nt">group</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">DailyJobs</span>
<span class="nt">tags</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">example</span>
<span class="nt">env</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">LOG_DIR</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${HOME}/logs</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">PATH</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/usr/local/bin:${PATH}</span>
<span class="nt">logDir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${LOG_DIR}</span>
<span class="nt">restartWaitSec</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">60</span>
<span class="nt">histRetentionDays</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3</span>
<span class="nt">delaySec</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="nt">maxActiveRuns</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="nt">params</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">param1 param2</span>
<span class="nt">preconditions</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">condition</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;`echo</span><span class="nv"> </span><span class="s">$2`&quot;</span>
<span class="w">    </span><span class="nt">expected</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;param2&quot;</span>
<span class="nt">mailOn</span><span class="p">:</span>
<span class="w">  </span><span class="nt">failure</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">success</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="nt">MaxCleanUpTimeSec</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">300</span>
<span class="nt">handlerOn</span><span class="p">:</span>
<span class="w">  </span><span class="nt">success</span><span class="p">:</span>
<span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;echo</span><span class="nv"> </span><span class="s">succeed&quot;</span>
<span class="w">  </span><span class="nt">failure</span><span class="p">:</span>
<span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;echo</span><span class="nv"> </span><span class="s">failed&quot;</span>
<span class="w">  </span><span class="nt">cancel</span><span class="p">:</span>
<span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;echo</span><span class="nv"> </span><span class="s">canceled&quot;</span>
<span class="w">  </span><span class="nt">exit</span><span class="p">:</span>
<span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;echo</span><span class="nv"> </span><span class="s">finished&quot;</span>
</pre></div>
</div>
</section>
<section id="all-available-fields-for-steps">
<h2><a class="toc-backref" href="#id17" role="doc-backlink">All Available Fields for Steps</a><a class="headerlink" href="#all-available-fields-for-steps" title="この見出しへのパーマリンク">¶</a></h2>
<p>Each step can have its own set of configurations, including:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">name</span></code>: The name of the step.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">description</span></code>: A brief description of the step.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dir</span></code>: The working directory for the step.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">command</span></code>: The command and parameters to execute.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">stdout</span></code>: The file to which the standard output is written.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">output</span></code>: The variable to which the result is written.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">script</span></code>: The script to execute.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">signalOnStop</span></code>: The signal name (e.g., <code class="docutils literal notranslate"><span class="pre">SIGINT</span></code>) to be sent when the process is stopped.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">mailOn</span></code>: Whether to send an email notification when the step fails or succeeds.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">continueOn</span></code>: Whether to continue to the next step, regardless of whether the step failed or not or the preconditions are met or not.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">retryPolicy</span></code>: The retry policy for the step.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">repeatPolicy</span></code>: The repeat policy for the step.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">preconditions</span></code>: The conditions that must be met before a step can run.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">depends</span></code>: The step depends on the other step.</p></li>
</ul>
<p>Example:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">steps</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">some task</span>
<span class="w">    </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">some task</span>
<span class="w">    </span><span class="nt">dir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${HOME}/logs</span>
<span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bash</span>
<span class="w">    </span><span class="nt">stdout</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/tmp/outfile</span>
<span class="w">    </span><span class="nt">output</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">RESULT_VARIABLE</span>
<span class="w">    </span><span class="nt">script</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">      </span><span class="no">echo &quot;any script&quot;</span>
<span class="w">    </span><span class="nt">signalOnStop</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;SIGINT&quot;</span>
<span class="w">    </span><span class="nt">mailOn</span><span class="p">:</span>
<span class="w">      </span><span class="nt">failure</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">      </span><span class="nt">success</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">continueOn</span><span class="p">:</span>
<span class="w">      </span><span class="nt">failure</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">      </span><span class="nt">skipped</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">retryPolicy</span><span class="p">:</span>
<span class="w">      </span><span class="nt">limit</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span>
<span class="w">      </span><span class="nt">intervalSec</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5</span>
<span class="w">    </span><span class="nt">repeatPolicy</span><span class="p">:</span>
<span class="w">      </span><span class="nt">repeat</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">      </span><span class="nt">intervalSec</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">60</span>
<span class="w">    </span><span class="nt">preconditions</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">condition</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;`echo</span><span class="nv"> </span><span class="s">$1`&quot;</span>
<span class="w">        </span><span class="nt">expected</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;param1&quot;</span>
<span class="w">    </span><span class="nt">depends</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">some task name step</span>
</pre></div>
</div>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">Dagu</a></h1>








<h3>ナビゲーション</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quick Start Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="cli.html">Command Line Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="web_interface.html">Web Interface</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">YAML Format</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#minimal-dag-definition">Minimal DAG Definition</a></li>
<li class="toctree-l2"><a class="reference internal" href="#specifying-working-directory">Specifying Working Directory</a></li>
<li class="toctree-l2"><a class="reference internal" href="#running-arbitrary-code-snippets">Running Arbitrary Code Snippets</a></li>
<li class="toctree-l2"><a class="reference internal" href="#defining-environment-variables">Defining Environment Variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="#defining-and-using-parameters">Defining and Using Parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="#using-command-substitution">Using Command Substitution</a></li>
<li class="toctree-l2"><a class="reference internal" href="#adding-conditional-logic">Adding Conditional Logic</a></li>
<li class="toctree-l2"><a class="reference internal" href="#user-defined-functions">User Defined Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#setting-environment-variables-with-standard-output">Setting Environment Variables with Standard Output</a></li>
<li class="toctree-l2"><a class="reference internal" href="#redirecting-stdout-and-stderr">Redirecting Stdout and Stderr</a></li>
<li class="toctree-l2"><a class="reference internal" href="#adding-lifecycle-hooks">Adding Lifecycle Hooks</a></li>
<li class="toctree-l2"><a class="reference internal" href="#repeating-a-task-at-regular-intervals">Repeating a Task at Regular Intervals</a></li>
<li class="toctree-l2"><a class="reference internal" href="#scheduling-a-dag-with-cron-expression">Scheduling a DAG with Cron Expression</a></li>
<li class="toctree-l2"><a class="reference internal" href="#all-available-fields-for-dags">All Available Fields for DAGs</a></li>
<li class="toctree-l2"><a class="reference internal" href="#all-available-fields-for-steps">All Available Fields for Steps</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="base_config.html">Base Configuration for all DAGs</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="config.html">Configuration Options</a></li>
<li class="toctree-l1"><a class="reference internal" href="auth.html">Basic Authentication</a></li>
<li class="toctree-l1"><a class="reference internal" href="api_token.html">API Token</a></li>
<li class="toctree-l1"><a class="reference internal" href="executors.html">Executors</a></li>
<li class="toctree-l1"><a class="reference internal" href="email.html">Sending Email Notifications</a></li>
<li class="toctree-l1"><a class="reference internal" href="scheduler.html">Scheduler</a></li>
<li class="toctree-l1"><a class="reference internal" href="docker-compose.html">Using Docker Compose</a></li>
<li class="toctree-l1"><a class="reference internal" href="rest.html">REST API Docs</a></li>
<li class="toctree-l1"><a class="reference internal" href="docker.html">Building Docker Image</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="contrib.html">Contribution Guide</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="web_interface.html" title="前の章へ">Web Interface</a></li>
      <li>Next: <a href="base_config.html" title="次の章へ">Base Configuration for all DAGs</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">クイック検索</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="検索" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2023, Dagu Developers.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 5.3.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="_sources/yaml_format.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>